/*!
 * @package Content Aware Sidebars
 * @author Joachim Jensen <jv@intox.dk>
 * @license GPLv3
 * @copyright 2016 by Joachim Jensen
 */
!function(a){var b={$sidebarContainer:a(".widget-liquid-right"),$widgetContainer:a("#available-widgets"),$widgets:null,init:function(){this.addSidebarToolbar(),this.addWidgetSearch()},addWidgetSearch:function(){this.$widgets=a(".widget",this.$widgetContainer).get().reverse(),a(".sidebar-description",this.$widgetContainer).prepend('<input type="search" class="js-cas-widget-filter cas-filter-widget" placeholder="'+CASAdmin.filterWidgets+'...">'),this.searchWidgetListener()},searchWidgetListener:function(){var b,c=this,d="";this.$widgetContainer.on("keyup",".js-cas-widget-filter",function(){var e=a(this).val();e!=d&&(d=e,b&&clearTimeout(b),b=setTimeout(function(){a(c.$widgets).each(function(b,c){var d=a(c);d.find(".widget-title :nth-child(1)").text().search(new RegExp(e,"i"))<0?d.fadeOut():(d.prependTo(d.parent()),d.fadeIn().css("display",""))})},250))})},addSidebarToolbar:function(){var a='<div class="wp-filter cas-filter-sidebar"><a href="post-new.php?post_type=sidebar" class="button button-primary">'+CASAdmin.addNew+'</a><input type="search" class="js-cas-filter" placeholder="'+CASAdmin.filterSidebars+'..."><a href="#" class="js-sidebars-toggle sidebars-toggle" data-toggle="0">'+CASAdmin.collapse+'</a><a href="#" class="js-sidebars-toggle sidebars-toggle" data-toggle="1">'+CASAdmin.expand+"</a></div>";this.$sidebarContainer.prepend(a),this.searchSidebarListener(),this.addSidebarToggle()},addSidebarToggle:function(){var b=a(document),c=this.$sidebarContainer.find(".widgets-holder-wrap");a("body").on("click",".js-sidebars-toggle",function(d){d.preventDefault();var e=!!a(this).data("toggle");c.toggleClass("closed",!e),e&&c.children(".widgets-sortables").sortable("refresh"),b.triggerHandler("wp-pin-menu")})},searchSidebarListener:function(){var b,c=this,d="";this.$sidebarContainer.on("keyup",".js-cas-filter",function(){var e=a(this).val();e!=d&&(d=e,b&&clearTimeout(b),b=setTimeout(function(){a(".widgets-holder-wrap",c.$sidebarContainer).each(function(b,c){var d=a(c);d.find(".sidebar-name :nth-child(2)").text().search(new RegExp(e,"i"))<0?d.fadeOut():d.fadeIn()})},250))})}};a(document).ready(function(){b.init()})}(jQuery);